/**
 * 月视图类型定义文件
 * 功能描述：定义wd-calendar-view组件月视图所需的所有类型、属性和配置项
 * 设计思路：将月视图特有的类型定义与其他视图分离，保持代码的模块化和可维护性
 * 使用场景：用于wd-calendar-view组件的月视图渲染和交互功能实现
 */

/**
 * 导入Vue相关类型
 * PropType: Vue的泛型类型工具，用于定义组件props的复杂类型
 */
import type { PropType } from 'vue'

/**
 * 导入通用属性构造函数
 * makeBooleanProp: 创建布尔类型属性的辅助函数，提供默认值为false
 * makeRequiredProp: 创建必选属性的辅助函数，确保属性必须被提供
 */
import { makeBooleanProp, makeRequiredProp } from '../../common/props'

/**
 * 导入日历基础类型
 * CalendarFormatter: 日历格式化函数类型，用于自定义日期项的显示和样式
 * CalendarType: 日历选择类型枚举，定义了多种选择模式
 */
import type { CalendarFormatter, CalendarType } from '../types'

/**
 * 月视图组件属性配置
 * 设计思路：定义月视图组件所需的所有配置属性，支持灵活的日历展示和交互需求
 * 与基础日历的关系：继承并扩展了基础日历的核心属性，专门针对月视图进行了优化
 */
export const monthProps = {
  /**
   * 日历选择类型
   * 功能：指定月视图的日期选择模式
   * 类型：CalendarType枚举值（'date' | 'dates' | 'datetime' | 'week' | 'month' | 'daterange' | 'datetimerange' | 'weekrange' | 'monthrange'）
   * 必要性：必填
   * 业务场景：根据不同业务需求选择合适的选择模式，如月视图主要支持日期相关的选择类型
   * 与月视图关系：决定月视图中日期的选择交互方式和状态显示逻辑
   */
  type: makeRequiredProp(String as PropType<CalendarType>),

  /**
   * 当前显示的日期
   * 功能：控制月视图显示哪个月份的日历
   * 类型：13位时间戳
   * 必要性：必填
   * 业务场景：用于初始化显示或用户切换月份时定位到指定日期
   * 与月视图关系：作为月视图生成日历数据的基准日期
   */
  date: makeRequiredProp(Number),

  /**
   * 选中值
   * 功能：绑定组件的选中状态，支持双向绑定
   * 类型：number（单选日期时间戳）| (number | null)[]（多选日期数组）| null（未选择）
   * 必要性：必填
   * 业务场景：存储用户选择的日期数据，根据不同的type类型有不同的格式
   * 与月视图关系：决定月视图中哪些日期需要显示为选中状态
   */
  value: makeRequiredProp([Number, Array, null] as PropType<number | (number | null)[] | null>),

  /**
   * 最小可选日期
   * 功能：限制月视图中可选择的最早日期
   * 类型：13位时间戳
   * 必要性：必填
   * 业务场景：如设置只能选择未来日期进行预约
   * 与月视图关系：用于计算月视图中哪些日期需要被禁用（不可点击）
   */
  minDate: makeRequiredProp(Number),

  /**
   * 最大可选日期
   * 功能：限制月视图中可选择的最晚日期
   * 类型：13位时间戳
   * 必要性：必填
   * 业务场景：如设置只能选择过去日期进行记录
   * 与月视图关系：用于计算月视图中哪些日期需要被禁用（不可点击）
   */
  maxDate: makeRequiredProp(Number),

  /**
   * 周起始天
   * 功能：定义月视图中每周的起始日期
   * 类型：数字，0表示周日，1-6表示周一至周六
   * 必要性：必填
   * 业务场景：满足不同国家/地区的周起始习惯，如中国通常以周一为起始
   * 与月视图关系：直接影响月视图的网格布局，决定日历第一列显示星期几
   */
  firstDayOfWeek: makeRequiredProp(Number),

  /**
   * 日期格式化函数
   * 功能：自定义月视图中每个日期项的显示和样式
   * 类型：CalendarFormatter类型函数
   * 必要性：可选
   * 业务场景：添加特殊标记、自定义文本、控制禁用状态等个性化需求
   * 与月视图关系：为月视图中的每个日期单元格提供自定义渲染逻辑
   */
  formatter: Function as PropType<CalendarFormatter>,

  /**
   * 最大日期范围
   * 功能：限制范围选择时的最大天数
   * 类型：数字
   * 必要性：可选
   * 业务场景：当type为daterange时，限制选择范围不能超过指定天数
   * 与月视图关系：在月视图中进行范围选择时，用于验证和限制选择范围
   */
  maxRange: Number,

  /**
   * 范围超出提示文案
   * 功能：当选择超出最大日期范围时的错误提示
   * 类型：字符串
   * 必要性：可选
   * 业务场景：当用户选择的范围超过maxRange时，提供友好的错误提示
   * 与月视图关系：在月视图中进行范围选择操作时提供即时反馈
   */
  rangePrompt: String,

  /**
   * 是否允许选择同一天
   * 功能：控制范围选择时是否允许起止日期相同
   * 类型：布尔值
   * 默认值：false
   * 必要性：可选
   * 业务场景：如请假是否允许请0.5天（起止时间不同但日期相同）
   * 与月视图关系：影响月视图中范围选择的交互逻辑和样式显示
   */
  allowSameDay: makeBooleanProp(false),

  /**
   * 默认时间
   * 功能：为选中的日期设置默认的时分秒数组
   * 类型：Array<number[]>，二维数组表示时间点[[小时, 分钟, 秒], [小时, 分钟, 秒]]
   * 必要性：可选
   * 业务场景：当需要精确到时间点的选择时，提供默认的时间值
   * 与月视图关系：在月视图选择日期后，结合默认时间生成完整的时间戳
   */
  defaultTime: {
    type: [Array] as PropType<Array<number[]>>
  },

  /**
   * 是否显示标题
   * 功能：控制是否显示月视图的标题（通常显示当前月份）
   * 类型：布尔值
   * 默认值：true
   * 必要性：可选
   * 业务场景：根据UI设计需求决定是否显示标题
   * 与月视图关系：控制月视图顶部标题栏的显示状态
   */
  showTitle: makeBooleanProp(true),

  /**
   * 是否显示农历
   * 功能：控制是否在月视图中显示农历日期
   * 类型：布尔值
   * 默认值：true
   * 必要性：可选
   * 业务场景：根据用户需求选择是否显示农历日期，如中国用户可能需要查看农历日期
   * 与月视图关系：影响月视图中日期项的显示内容，增加了日期的可读性
   */
  showLunar: makeBooleanProp(true),
  /**
   * 是否显示月份背景
   * 功能：控制是否在日期项中显示特殊标记（月份背景）
   * 类型：布尔值
   * 默认值：true
   * 业务场景：如需要突出显示月份背景
   */
  showMark: makeBooleanProp(true)
}

/**
 * 月视图组件属性类型
 * 设计思路：从monthProps对象中提取属性类型定义
 * 使用场景：在TypeScript项目中提供完整的类型推断支持，确保组件使用时类型安全
 * 类型导出：允许在组件实现和使用中引用该类型定义
 */
export type MonthProps = typeof monthProps

/**
 * 月视图类型定义与组件渲染交互的关系分析
 * 设计思路：通过类型系统支撑月视图的复杂渲染和交互需求
 */

/**
 * 1. 月视图渲染支撑机制
 * - date属性：作为基准日期，用于计算并生成当月的日历网格数据，确定显示哪些日期
 * - firstDayOfWeek属性：决定月视图的网格布局结构，控制每周的起始列显示
 * - minDate/maxDate属性：用于过滤和禁用超出范围的日期，确保用户只能选择有效日期
 * - formatter函数：为每个日期项提供自定义渲染逻辑，支持特殊日期标记、自定义文本等
 * - showTitle属性：控制月视图头部标题的显示状态，影响整体布局结构
 */

/**
 * 2. 月视图交互逻辑支撑
 * - type属性：决定月视图支持的交互模式（单选、多选、范围选择等）
 * - value属性：存储用户的选择状态，支持双向数据绑定，实现视图与数据的同步
 * - allowSameDay属性：控制范围选择时的特殊交互行为，影响用户操作体验
 * - maxRange和rangePrompt属性：实现范围选择的限制和反馈机制
 * - defaultTime属性：在需要精确时间选择的场景下，提供默认时间值支持
 */

/**
 * 3. 类型系统与组件架构的关系
 * - MonthProps类型导出：确保组件实现和使用时的类型安全，减少运行时错误
 * - 与基础类型的引用关系：通过导入CalendarType和CalendarFormatter等基础类型，
 *   实现了视图类型与基础功能的解耦和复用
 * - 属性构造函数的使用：通过makeBooleanProp和makeRequiredProp等辅助函数，
 *   标准化属性定义，提高代码可维护性
 */

/**
 * 4. 多场景适配能力
 * - 不同type类型支持：通过类型定义支持从简单的日期选择到复杂的日期时间范围选择
 * - 国际化支持：通过firstDayOfWeek属性支持不同地区的周起始习惯
 * - 自定义扩展：通过formatter函数提供灵活的自定义能力，满足各种业务场景需求
 */
